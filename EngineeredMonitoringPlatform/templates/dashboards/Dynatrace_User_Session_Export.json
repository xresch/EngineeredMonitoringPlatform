{"success": true,"messages": [],"payload": [
  {
    "PK_ID": 29,
    "FK_ID_USER": 1,
    "NAME": "Dynatrace User Session Export",
    "DESCRIPTION": null,
    "TAGS": null,
    "IS_SHARED": false,
    "JSON_SHARE_WITH_USERS": {},
    "JSON_SHARE_WITH_GROUPS": {},
    "JSON_EDITORS": {},
    "JSON_EDITOR_GROUPS": {},
    "ALLOW_EDIT_SETTINGS": true,
    "TIME_CREATED": 1736258718083,
    "LAST_UPDATED": null,
    "IS_PUBLIC": false,
    "START_FULLSCREEN": false,
    "IS_DELETABLE": true,
    "IS_RENAMABLE": true,
    "IS_ARCHIVED": false,
    "VERSION_GROUP": "66893104-ee6c-418f-bfce-3709cf275411",
    "VERSION": 0,
    "username": "admin",
    "widgets": [
      {
        "PK_ID": 378,
        "FK_ID_DASHBOARD": 29,
        "TYPE": "cfw_widget_queryresults",
        "X": 0,
        "Y": 8,
        "WIDTH": 61,
        "HEIGHT": 54,
        "TITLE": null,
        "TITLE_LINK": null,
        "TITLE_INFO": null,
        "TITLE_FONTSIZE": null,
        "TITLE_POSITION": "top",
        "TITLE_ALIGN": "start",
        "CONTENT_FONTSIZE": null,
        "FOOTER": null,
        "BGCOLOR": "null",
        "FGCOLOR": "null",
        "INVISIBLE": false,
        "PAUSE": false,
        "MANUAL_LOAD": false,
        "PARAM_WIDGET_LOAD": false,
        "JSON_SETTINGS": {
          "query": "###########################################################\r\n# \r\n###########################################################\r\n/*\r\nFields of interest:\r\nUID\r\nSession ID\r\nBooking Center\r\nSession Start\r\nSession Duration\r\nIP Address\r\nUser Action Count\r\nPage Views\r\nService Center\r\n*/\r\n| meta \r\n\tname \u003d \"User Session Statistics\"\r\n\ttitle \u003d true \r\n| paramdefaults\r\n\tapplication \u003d \"%\"\r\n\tuser \u003d \"%\"\r\n\tstep \u003d 60 \r\n\tunit \u003d \u0027m\u0027\r\n\tsize \u003d 5000\r\n| globals\r\n\tINITIAL_LATEST \u003d latest()\r\n\tCREDENTIALS \u003d credentials(\"DYN_API_PROD\")\r\n\tQUERY \u003d encode(`\r\nSELECT \r\n\t  userSessionId\r\n\t, userId\r\n\t, ip\r\n\t, useraction.application \r\n\t, useraction.startTime\r\n\t, useraction.endTime\r\n\t, useraction.targetURL\r\nFROM usersession\r\nWHERE useraction.application LIKE \"`+param(application, \"%\")+`\"\r\n  AND userId  LIKE \"`+param(user, \"%\")+`\"\r\n`)\r\n| source web \r\n\tas \u003d json\r\n\turl \u003d globals(CREDENTIALS).url \r\n\t\t\t\t+ \"/api/v1/userSessionQueryLanguage/table?\"\r\n\t\t\t\t+\"addDeepLinkFields\u003dfalse\"\r\n\t\t\t\t+\"\u0026explain\u003dfalse\"\r\n\t\t\t\t+\"\u0026startTimestamp\u003d\" + earliest()\r\n\t\t\t\t+\"\u0026endTimestamp\u003d\" + latest()\r\n\t\t\t\t+\"\u0026pageSize\u003d\" + param(size)\r\n\t\t\t\t+\"\u0026query\u003d\"+globals(QUERY)\r\n\r\n\theaders \t\u003d object( \"Authorization\" \"Api-Token \"+ globals(CREDENTIALS).password )\r\n\t\r\n\tpagination \t\u003d true # enable pagination\r\n\t\r\n\tpageinitial \u003d latestSet(earliest(), param(step), \"m\") # initial page value \r\n\t\r\n\tpage \t\t\u003d timeframeOffset(0, param(step), \"m\") # adjust the initial value every time\r\n\t\t\t\t  \r\n\tpageend \t\u003d ( \r\n\t\t\t\t\t latest() \u003e globals(INITIAL_LATEST)\r\n\t\t\t\t\t OR timeOffset(earliest(), globals(step), \"m\") \u003e\u003d globals(INITIAL_LATEST)\r\n\t\t\t\t  ) # return true when end condition has been reached\r\n\t\r\n\tpagemax \t\u003d 1000 # the max number of pages to fetch, prevents endless loops\r\n\t\r\n| filter length(values) \u003e 0 \r\n\tAND isUndef(error)\r\n| unbox values\r\n| set\r\n\t\"sessionID\" \t\u003d values[0]\r\n\t\"userID\" \t\t\u003d values[1]\r\n\t\"IP\"\t\t\t\u003d values[2]\r\n\t\"application\" \t\u003d values[3]\r\n\t\"startTime\" \t\u003d values[4]\r\n\t\"endTime\" \t\t\u003d values[5]\r\n\t\"URL\"\t\t\t\u003d values[6]\r\n| remove columnNames, values, extrapolationLevel, error\r\n| maparrays replace \u003d true\r\n\tapplication\r\n\tstartTime\r\n\tendTime\r\n\tURL\r\n\t\r\n| unbox maparrays\r\n| unbox maparrays\r\n| remove maparrays\r\n| stats\r\n\tby \u003d [sessionID, userID, IP, application]\r\n\tactions \u003d count()\r\n\tstartTime \u003d min(startTime)\r\n\tendTime \u003d max(endTime)\r\n\t\r\n| set\r\n\tduration \u003d endTime - startTime\r\n\ttech \u003d extract(application, \".*_T_([^_]*?)_.*\", 0)\r\n\tenv \u003d extract(application, \".*_E_([^_]*?)_.*\", 0)\r\n\tloc \u003d extract(application, \".*_L_([^_]*?)_.*\", 0)\r\n\tinstance \u003d extract(application, \".*_I_([^_]*?)_.*\", 0)\r\n\tappName \u003d extract(application, \".*_A_(.*?)].*\", 0)\r\n| formatfield\r\n\t[startTime, endTime] \u003d timestamp\r\n\tduration \u003d duration\r\n| display download \u003d true\r\n\r\n\r\n\r\n\r\n",
          "sampledata": false
        },
        "JSON_TASK_PARAMETERS": {}
      },
      {
        "PK_ID": 379,
        "FK_ID_DASHBOARD": 29,
        "TYPE": "cfw_parameter",
        "X": 0,
        "Y": 0,
        "WIDTH": 61,
        "HEIGHT": 8,
        "TITLE": null,
        "TITLE_LINK": null,
        "TITLE_INFO": null,
        "TITLE_FONTSIZE": null,
        "TITLE_POSITION": "top",
        "TITLE_ALIGN": "start",
        "CONTENT_FONTSIZE": null,
        "FOOTER": null,
        "BGCOLOR": "null",
        "FGCOLOR": "null",
        "INVISIBLE": false,
        "PAUSE": false,
        "MANUAL_LOAD": false,
        "PARAM_WIDGET_LOAD": false,
        "JSON_SETTINGS": {
          "description": null,
          "JSON_PARAMETERS": {
            "127": "application",
            "128": "user",
            "131": "environment"
          },
          "addtotop": false,
          "showbutton": true,
          "buttonlabel": null,
          "checkpassword": false,
          "password": null,
          "JSON_AFFECTED_WIDGETS": {},
          "load_previous_values": true
        },
        "JSON_TASK_PARAMETERS": {}
      }
    ],
    "parameters": [
      {
        "PK_ID": 135,
        "FK_ID_DASHBOARD": 29,
        "WIDGET_TYPE": null,
        "LABEL": "Query Select",
        "PARAM_TYPE": "QUERY_EDITOR",
        "NAME": "application",
        "VALUE": "###########################################################\r\n# Get List of Applications active in the last 1 month\r\n###########################################################\r\n| globals\r\n\tCREDENTIALS \u003d $environment$\r\n\tQUERY \u003d encode(`SELECT DISTINCT application\r\n\t\t\t\t\tFROM useraction\r\n\t\t\t\t\tORDER BY application`)\r\n;\r\n| meta name \u003d \"applications\"\r\n| source web \r\n\turl\u003d (\r\n\t\tglobals(CREDENTIALS).url + \"/api/v1/userSessionQueryLanguage/table?\"\r\n\t\t\t\t\t\t\t\t\t\t+\"query\u003d\"+globals(QUERY)\r\n\t\t\t\t\t\t\t\t\t\t+\"\u0026addDeepLinkFields\u003dfalse\"\r\n\t\t\t\t\t\t\t\t\t\t+\"\u0026explain\u003dfalse\"\r\n\t\t\t\t\t\t\t\t\t\t+\"\u0026startTimestamp\u003d\"+now(null, -1, \"M\")\r\n\t\t\t\t\t\t\t\t\t\t+\"\u0026endTimestamp\u003d\"+now()\r\n\t\t\t\t\t\t\t\t\t\t+\"\u0026pageSize\u003d5000\"\r\n\t)\r\n\theaders \u003d object( \"Authorization\" \"Api-Token \"+ globals(CREDENTIALS).password )\r\n| unbox values\r\n| set \r\n\t\"VALUE\" \u003d values[0]\r\n\t\"LABEL\" \u003d values[0]\r\n| keep VALUE, LABEL\r\n;\r\n| mimic name\u003d\"applications\"\r\n| set \r\n\tLABEL \u003d substring(LABEL, 0, indexOf(LABEL, \" [\" ))\r\n\tVALUE \u003d LABEL+\"%\"\r\n| distinct VALUE\r\n;\r\n| resultconcat\r\n| sort LABEL\r\n;\r\n| resultconcat\r\n| record\r\n\t[\"VALUE\", \"LABEL\"]\r\n\t[\"%\", \"All Applications\"]",
        "MODE": "MODE_SUBSTITUTE",
        "IS_MODE_CHANGE_ALLOWED": false,
        "IS_DYNAMIC": true
      },
      {
        "PK_ID": 136,
        "FK_ID_DASHBOARD": 29,
        "WIDGET_TYPE": null,
        "LABEL": "Text",
        "PARAM_TYPE": "TEXT",
        "NAME": "user",
        "VALUE": "%",
        "MODE": "MODE_SUBSTITUTE",
        "IS_MODE_CHANGE_ALLOWED": false,
        "IS_DYNAMIC": false
      },
      {
        "PK_ID": 137,
        "FK_ID_DASHBOARD": 29,
        "WIDGET_TYPE": null,
        "LABEL": "Select",
        "PARAM_TYPE": "VALUE_LABEL",
        "NAME": "environment",
        "VALUE": "{\"credentials(\\\"DYN_API_PROD\\\")\":\"PROD\"}",
        "MODE": "MODE_SUBSTITUTE",
        "IS_MODE_CHANGE_ALLOWED": false,
        "IS_DYNAMIC": false
      },
      {
        "PK_ID": 138,
        "FK_ID_DASHBOARD": 29,
        "WIDGET_TYPE": null,
        "LABEL": "Number",
        "PARAM_TYPE": "NUMBER",
        "NAME": "minimum_duration",
        "VALUE": "3000",
        "MODE": "MODE_SUBSTITUTE",
        "IS_MODE_CHANGE_ALLOWED": false,
        "IS_DYNAMIC": false
      }
    ]
  }
]}
